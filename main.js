(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var d=e[s],l=r.base?d[0]+r.base:d[0],h=i[l]||0,c="".concat(l," ").concat(h);i[l]=h+1;var p=n(c),u={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var m=o(u,r);r.byIndex=s,t.splice(s,0,{identifier:c,updater:m,references:1})}a.push(c)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var d=r(e,o),l=0;l<i.length;l++){var h=n(i[l]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}i=d}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},208:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,':root {\n    --cell-size: 2rem;\n    --color-blue: rgb(37, 54, 99);\n    --color-ligth-blue: rgb(124, 167, 231);\n    --color-green:  rgb(96, 185, 123);\n    --color-red: rgb(201, 65, 65); \n}\n\nbody {     \n    display: grid;\n    justify-content: center; \n    margin: 0;\n    user-select: none; \n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n    color: rgb(199, 196, 196);\n    letter-spacing: 1px;\n    background-color: rgb(37, 54, 99);    \n}\n\nheader {\n    position: relative;\n    text-align: center;\n    font-size: 1.5rem;\n    letter-spacing: 4px;\n    font-weight: bold;\n    padding: 4rem 0;    \n    color: var(--color-green); \n    width: 100vw;    \n\n    span:nth-child(2) {\n        color: var(--color-ligth-blue); \n    }\n\n    #button-drag-and-drop {\n        position: absolute;\n        cursor: pointer;\n        top: 0;\n        bottom: 0;\n        margin: auto 0;\n        right: 4rem;\n        height: 3rem;\n        width: 3rem;\n        font-size: 2rem;\n        background-color: var(--color-blue); \n        border: none;         \n        color: rgb(226, 226, 90);\n        opacity: 0.8;        \n    }\n\n    #button-drag-and-drop:hover {        \n        opacity: 1;\n    }\n}\n\nmain { \n    position: relative;  \n    display: flex;\n    gap: 4rem;\n    justify-content: center;   \n}\n\n.board-row {\n    display: flex;\n}\n\n.board-title-human,\n.board-title-computer {\n    text-align: center;\n    height: 60px;\n    color: var(--color-green);   \n}\n\n.board-cell,\n.board-cell-nohover {\n    position: relative;\n    width: var(--cell-size);\n    aspect-ratio: 1;  \n    display: grid;\n    justify-content: center;\n    align-items: center;   \n    border-style: none; \n    cursor: pointer; \n    background: rgb(51, 72, 128);    \n    border-radius: 2px;  \n}\n\n.board-cell:hover {   \n    border: solid 1px rgb(75, 120, 187);   \n}\n\n.board-cell-nohover {    \n    cursor: auto;   \n}\n\n.marker-col,\n.marker-row {\n    position: absolute;   \n    width: 100%;\n    text-align: center;   \n    color: rgb(178, 178, 180);\n    pointer-events: none;\n}\n\n.marker-col {\n    top: -1.5rem;\n    left: 0;\n    font-size: 12px;\n}\n\n.marker-row {   \n    left: -2.5rem;\n    font-size: 14px;    \n}\n\n#computer,\n#human {\n    position: relative; \n    display: grid;\n    gap: 2px;      \n}\n\n.board-row {   \n    gap: 2px; \n}\n\n.ship-draggable {\n    position: absolute;\n    display: flex;   \n    border: solid 2px var(--color-ligth-blue);\n    cursor: move;\n    z-index: 100;\n    /* left: -2px; */\n    top: 0px;\n    border-radius: 2px;\n}\n\n#ships-overlay-computer,\n#ships-overlay-human,\n#ships-overlay-extra,\n#board-overlay-computer,\n#board-overlay-human {\n    position: absolute;\n    top: 0;\n    left: 0;   \n    width: 100%;\n    height: 100%;\n    pointer-events: none; \n    /* outline: solid 2px rgb(37, 54, 99);   */\n}\n\n#ships-overlay-extra {\n    z-index: 100;\n    outline: none;    \n}\n\n#board-overlay-computer,\n#board-overlay-human {\n    top: -4.5rem;\n    left: 5.5rem;\n    width: 10rem;\n    height: 2.5rem;    \n}\n\n.selected-board {\n    border: solid 1px rgb(201, 199, 105);\n    border-radius: 4px;\n}\n\n.selected-board {\n    animation: blinker 1s linear infinite;\n  }\n  \n  @keyframes blinker {\n    50% {\n      opacity: 0.4;\n    }\n  }\n\n.ship-overlay,\n.ship-overlay-blue,\n.ship-overlay-sunk {\n    position: absolute;   \n    border-radius: 2px; \n    top: 0px;\n    left: 0px;     \n}\n\n.ship-overlay-blue {   \n    background-color: rgb(83, 109, 182);\n    border: none;\n    outline: solid 2px rgb(31, 46, 87);   \n}\n\n.ship-overlay-green {    \n    outline: solid 2px rgb(130, 187, 130);   \n}\n\n.ship-overlay-red {   \n    background-color: var(--color-blue); \n    outline: solid 2px var(--color-red);\n}\n\n.cell-shot {\n    background-color:  rgb(37, 54, 99);\n}\n\n.cell-hit::before { \n    content: "âœ•";\n    color: var(--color-red);\n    font-size: 1.5rem; \n    display: grid;\n    justify-content: center;\n    align-items: center; \n    z-index: 200;           \n}\n\n.notification-wrap { \n    display: grid;\n    justify-items: center;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(170, 168, 168, 0.1); \n}\n\n.notification { \n    display: flex;\n    justify-content: space-between;    \n    align-items: center; \n    width: 25rem;\n    height: 4rem; \n    padding: 0 1.5rem;\n    color: white; \n    font-size: 20px;\n    margin-top: 1rem;  \n}\n\n.notification-win {\n    background-color: var(--color-green);\n}\n\n.notification-lose {\n    background-color: var(--color-red);\n}\n\n.button-rematch {\n    cursor: pointer; \n    border: solid 1px rgb(238, 235, 235);   \n    background-color: rgb(224, 224, 111);\n    color: rgb(19, 18, 18);\n    padding: 4px 8px;\n    font-size: 16px; \n}\n\n.ships-port {\n    display: grid;\n    gap: 1rem;   \n    height: 260px;   \n}\n\n.ships-port-line {\n    position: relative;\n    display: flex;\n    gap: 1.5rem;\n}\n\n.ship-box {\n    position: relative;    \n    border: dotted 1px rgb(89, 112, 212);\n    border-radius: 2px;  \n    /* padding-right: 4px;\n    padding-bottom: 2px;\n    border-radius: 2px; */\n}\n\n.ship-box-length-1,\n.ship-box-length-2,\n.ship-box-length-3,\n.ship-box-length-4 {\n    height: 34px;\n}\n\n.ship-box-length-1 {\n    width: 34px;    \n}\n\n.ship-box-length-2 {\n    width: 68px;   \n}\n\n.ship-box-length-3 {\n    width: 102px;   \n}\n\n.ship-box-length-4 {\n    width: 136px;     \n}\n\n.draggable-ships-container {\n    display: grid;\n    width: 280px;\n    padding-top: 60px;\n    gap: 2.5rem;\n}\n\n.pre-game-buttons-container {   \n    display: flex;\n    justify-content: space-between;\n    padding: 1rem 0;    \n  \n    button {\n        cursor: pointer;     \n        font-size: 1rem;\n        padding: 4px 8px;\n        border: solid 2px;\n        border-radius: 4px;                \n    }    \n}\n\n#button-randomize {  \n    color: var(--color-ligth-blue); \n    background-color: var(--color-blue);\n    border-color: var(--color-ligth-blue);   \n}\n\n#button-start-game:hover,\n#button-randomize:hover {  \n    opacity: 1;\n}\n\n#button-start-game {\n    color: var(--color-green);\n    background-color: var(--color-blue);\n    border: solid 2px var(--color-green);      \n}\n\nbutton:disabled {\n    opacity: 0.3;  \n    pointer-events: none;\n}\n\n.ship-cell {\n    width: var(--cell-size);\n    height: var(--cell-size);    \n}\n\n.disabled {\n    pointer-events: none;\n    opacity: 0.1;\n}\n\n.cell-disabled {\n    pointer-events: none; \n}\n\n.board-disabled {\n    pointer-events: none; \n    opacity: 0.8;  \n}\n\n.hidden {\n    visibility: hidden;\n}\n\n.ship-draggable[data-direction="vertical"] {\n    display: grid;\n}\n\n.ship-draggable[data-length="4"][data-direction="vertical"] {   \n    width: 32px;\n    height: 134px;\n}\n\n.ship-draggable[data-length="3"][data-direction="vertical"] {\n    width: 32px;\n    height: 100px;\n}\n\n.ship-draggable[data-length="2"][data-direction="vertical"] {\n    width: 32px;\n    height: 66px;\n}\n\n.ship-draggable[data-length="4"][data-direction="horizontal"] {\n    width: 134px;   \n}\n\n.ship-draggable[data-length="3"][data-direction="horizontal"] {\n    width: 100px;   \n}\n\n.ship-draggable[data-length="2"][data-direction="horizontal"] {\n    width: 66px;    \n}\n\n.ship-rotation-error {\n    animation: shake 0.82s;   \n    outline: solid 1px var(--color-red);\n    /* background-color: rgba(248, 136, 136, 0.1); */\n}\n  \n@keyframes shake {\n    10%, 90% { transform: translate3d(-1px, 0, 0); }\n    20%, 80% { transform: translate3d(2px, 0, 0); }\n    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }\n    40%, 60% { transform: translate3d(4px, 0, 0); }\n}\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n ',""]);const s=a},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var d=this[s][0];null!=d&&(a[d]=!0)}for(var l=0;l<e.length;l++){var h=[].concat(e[l]);r&&a[h[0]]||(void 0!==i&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=i),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),o&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=o):h[4]="".concat(o)),t.push(h))}},t}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var r=n(72),o=n.n(r),i=n(825),a=n.n(i),s=n(659),d=n.n(s),l=n(56),h=n.n(l),c=n(540),p=n.n(c),u=n(113),m=n.n(u),g=n(208),b={};b.styleTagTransform=m(),b.setAttributes=h(),b.insert=d().bind(null,"head"),b.domAPI=a(),b.insertStyleElement=p(),o()(g.A,b),g.A&&g.A.locals&&g.A.locals;class f{renderHeaderAndMain(){document.querySelector("body").innerHTML='\n                <header><span>BATTLE</span><span>SHIP</span>\n                    <button id="button-drag-and-drop" title="Home"><i class="fa fa-home"></i></button>\n                </header> \n                <main></main>                         \n                '}renderMainSections(e){const t=document.querySelector("main");t.innerHTML="",t.appendChild(this.renderShipsPortSection()),t.appendChild(this.renderPlayerSection(e))}renderBoard(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;e.innerHTML="";const n=["A","B","C","D","E","F","G","H","I","J"];for(let r=0;r<t;r++){const o=document.createElement("div");o.classList.add("board-row");for(let i=0;i<t;i++){const t=document.createElement("button");if(0===r){const e=document.createElement("div");e.classList.add("marker-col","marker"),e.innerHTML=n[i],t.appendChild(e)}if(0===i){const e=document.createElement("div");e.classList.add("marker-row","marker"),e.innerHTML=r+1,t.appendChild(e)}"human"===e.id?t.classList.add("board-cell-nohover"):t.classList.add("board-cell"),t.setAttribute("data-row",r),t.setAttribute("data-col",i),t.title=`Board cell row ${r} column ${i}`,o.appendChild(t)}e.appendChild(o)}e.append(this.renderShipsOverlay(e.id)),e.append(this.renderExtraShipsOverlay()),e.append(this.renderBoardOverlay(e.id))}renderShipsOverlay(e){const t=document.createElement("div");return t.id=`ships-overlay-${e}`,t}renderExtraShipsOverlay(){const e=document.createElement("div");return e.id="ships-overlay-extra",e}renderBoardOverlay(e){const t=document.createElement("div");return t.id=`board-overlay-${e}`,t}renderShips(e,t){for(const n of t)e.querySelector(`button[data-row='${n.row}'][data-col='${n.col}']`).classList.add("ship")}renderShots(e,t){for(const n of t){const t=n.split(",")[0],r=n.split(",")[1];e.querySelector(`button[data-row='${t}'][data-col='${r}']`).classList.add("cell-shot")}}renderHits(e,t){for(const n of t)e.querySelector(`button[data-row='${n.row}'][data-col='${n.col}']`).classList.add("cell-hit")}renderPlayerSection(e){const t=document.createElement("section");let n;return t.classList.add("section-player"),n="human"===e.type?"Your board":"Opponent's board",t.innerHTML=`                  \n                        <div class="board-title-${e.type}">${n}</div>\n                        <div id="${e.type}"></div>                                                                   \n                    `,t}renderNotification(){const e=document.createElement("div");return e.classList.add("notification-wrap"),e.innerHTML='\n                    <div class="notification">                 \n                        <p class="message"></p>\n                        <button class="button-rematch">Rematch</button>\n                    </div>\n                       ',e}renderShipsPortSection(){const e=document.createElement("section");return e.classList.add("section-ships"),e.innerHTML='                      \n                            <div class="draggable-ships-container">\n                                <div class="draggable-ships-instruction">\n                                    Drag the ships to the board. Click on any ship on the board to rotate.\n                                </div>                           \n                                <div class="ships-port">                                                  \n                                </div>\n                            </div>                                                                        \n                        ',e}renderShipsPortLines(){const e=document.querySelector(".ships-port");let t=4;for(let n=1;n<=4;n++){const r=document.createElement("div");r.classList.add("ships-port-line"),r.setAttribute("data-number-of-ships",n),r.setAttribute("data-ships-length",t),r.id="ships-port-line-"+n,e.appendChild(r),t-=1}}renderShipsBoxes(){const e=document.querySelectorAll(".ships-port-line");for(const t of e){const e=t.getAttribute("data-number-of-ships"),n=t.getAttribute("data-ships-length");for(let r=0;r<e;r++){const e=document.createElement("div");e.classList.add("ship-box","ship-box-length-"+n),e.setAttribute("data-length",n),t.appendChild(e)}}}renderShipsDivs(e){let t=1;if(e)return void e.gameboard.ships.forEach((e=>{if(!e)return;const{ship:n,row:r,col:o}=e,i=document.querySelector(`button[data-row='${r}'][data-col='${o}']`),a=this.renderShipDiv(t,n.length,n.direction);a.classList.add("ship-draggable","ship-overlay","ship-overlay-blue"),i.append(a),t++}));const n=document.querySelectorAll(".ships-port-line");for(const e of n){const n=e.querySelectorAll(".ship-box");for(const e of n){const n=e.getAttribute("data-length"),r=this.renderShipDiv(t,n);r.classList.add("ship-draggable"),e.appendChild(r),t++}}}renderShipDiv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"horizontal";const r=document.createElement("div");r.id="ship-"+e,r.setAttribute("data-length",t),r.setAttribute("data-direction",n),r.draggable=!0;for(let e=0;e<t;e++){const t=document.createElement("div");t.setAttribute("data-offset",e),t.classList.add("ship-cell"),r.appendChild(t)}return r}renderPreGameButtons(){const e=document.querySelector(".section-player"),t=document.createElement("div");t.classList.add("pre-game-buttons-container"),t.innerHTML='\n                                <div>\n                                    <button id="button-randomize">Randomize</button>                                                                    \n                                </div>  \n                                <div>                                                                  \n                                    <button id="button-start-game" data-ship-placement="random" disabled>Start Game</button>\n                                </div>    \n                                ',e.appendChild(t)}}class v{#e=10;constructor(){this.board=this.createBoard(),this.missedAttacks=new Set,this.hits=[],this.ships=[]}createBoard(){const e=[];for(let t=0;t<this.#e;t++){e[t]=[];for(let n=0;n<this.#e;n++)e[t][n]=null}return e}isValidCoordinates(e,t){return e>=0&&t>=0&&e<this.#e&&t<this.#e}isInBounds(e,t,n){let r=t;return"vertical"===n.direction&&(r=e),r+n.length<=this.#e}isEmptySquare(e,t){return null===this.board[e][t]}getShipEdges(e,t,n){const r="horizontal"===n.direction?1:n.length,o="horizontal"===n.direction?n.length:1,i=e+r,a=t-1,s=t+o;let d=[];for(let n=e-1;n<=i;n++)for(let i=a;i<=s;i++)n>=e&&i>=t&&n<e+r&&i<t+o||!this.isValidCoordinates(n,i)||d.push([n,i]);return d}placeShip(e,t){let[n,r]=e;if(!this.isValidCoordinates(n,r)||!this.isInBounds(n,r,t))return!1;for(let e=0;e<t.length;e++){const o="horizontal"===t.direction?n:n+e,i="horizontal"===t.direction?r+e:r;if(!this.isEmptySquare(o,i))return!1;const a=this.getShipEdges(n,r,t);for(const[e,t]of a)if(null!==this.board[e][t]&&"X"!==this.board[e][t])return!1;this.board[o][i]={ship:t,shipStartRow:n,shipStartCol:r,hit:!1}}return this.ships.push({ship:t,row:n,col:r}),!0}receiveAttack(e,t){let n=this.board[e][t];if(null===n)return this.missedAttacks.add(`${e},${t}`),void(this.board[e][t]="Missed shot");if(!0!==n.hit&&"Missed shot"!==n){if(this.board[e][t].hit=!0,this.hits.push({row:e,col:t}),n.ship.hit(),n.ship.isSunk()){const e=this.getShipEdges(n.shipStartRow,n.shipStartCol,n.ship);for(const t of e)this.missedAttacks.add(`${t[0]},${t[1]}`)}return!0}}isAllShipsSunk(){return this.ships.every((e=>e.ship.isSunk()))}isShipExist(e){return this.ships.some((t=>t.ship.id===e.id))}getShipById(e){return this.ships.filter((t=>t.ship.id===e))[0]}updateShipData(e,t,n,r,o){for(const i of this.ships)i.ship.id===e.id&&(i.row=t,i.col=n,i.ship.edges=r,i.ship.direction=o)}getPreviousShipData(e){for(const t of this.ships)if(t.ship.id===e.id)return[t.row,t.col,t.ship.direction,t.ship.edges]}removePreviousShip(e,t,n){for(let r=0;r<e.length;r++){const o="horizontal"===e.direction?t:t+r,i="horizontal"===e.direction?n+r:n;this.board[o][i]=null}}removeShipFromArray(e){return this.ships=this.ships.filter((t=>t.ship.id!==e.id))}isRotationPossible(e,t,n,r){if(this.clearShipEdges(e.edges),2===e.length)for(const t of this.ships)t.ship.id!==e.id&&this.markShipEdges(t.ship.edges);for(let o=1;o<e.length;o++){const i="horizontal"===t?n:n+o,a="horizontal"===t?r+o:r;if(!this.isValidCoordinates(i,a))return!1;if(null!==this.board[i][a])return this.markShipEdges(e.edges),!1}return!0}isDropPossible(e,t,n){if(this.isInBounds(t,n,e)){for(let r=0;r<e.length;r++){const o="horizontal"===e.direction?t:t+r,i="horizontal"===e.direction?n+r:n;if(null!==this.board[o][i])return!1}return!0}}markShipEdges(e){for(const[t,n]of e)this.board[t][n]="X"}clearShipEdges(e){for(const[t,n]of e)this.board[t][n]=null}clearBoard(){this.board=this.createBoard(),this.missedAttacks=new Set,this.hits=[],this.ships=[]}}class y{constructor(e,t){this.type=e,this.gameboard=t}}class S{constructor(e){this.id,this.length=e,this.hits=0,this.sunk=!1,this.direction="horizontal"}isSunk(){return this.hits===this.length&&(this.sunk=!0),this.sunk}hit(){this.hits<this.length&&this.hits++}rotate(){"horizontal"===this.direction?this.direction="vertical":this.direction="horizontal"}}class x{constructor(){this.player1=new y("human",new v),this.player2=new y("computer",new v),this.players=[this.player1],this.currentPlayer=this.player1,this.dom=new f,this.preGameSetup(this.player1)}preGameSetup(e){this.dom.renderHeaderAndMain(),this.dom.renderMainSections(e),this.dom.renderShipsPortLines(),this.dom.renderShipsBoxes(),this.dom.renderShipsDivs(),this.dom.renderPlayerSection(e);const t=document.querySelector(`#${e.type}`);this.dom.renderBoard(t),this.dom.renderPreGameButtons(),this.addListenersPreGameButtons(e),this.handleDragAndDrop(e)}addBoardEventListeners(e,t){const n=e.querySelectorAll("[data-row][data-col]");if("human"!==t.type)for(const e of n)(e.classList.contains("cell-shot")||e.classList.contains("cell-hit"))&&e.classList.add("cell-disabled"),e.onclick=()=>{const n=e.getAttribute("data-row"),r=e.getAttribute("data-col");this.handleShot(n,r,t.gameboard)}}updateBoards(){for(const e of this.players){const t=document.querySelector(`#${e.type}`);this.dom.renderBoard(t),this.dom.renderShips(t,e.gameboard.ships),this.drawShipsOverlay(e),this.dom.renderShots(t,e.gameboard.missedAttacks),this.dom.renderHits(t,e.gameboard.hits),this.addBoardEventListeners(t,e)}}startGame(){const e=document.querySelector("main");e.innerHTML="";for(const t of this.players)e.appendChild(this.dom.renderPlayerSection(t));this.updateBoards(),this.placeShipsRandomly(this.player2),this.drawShipsOverlay(this.player2),document.getElementById("human").classList.add("board-disabled")}placeShipsRandomly(e){const t=[4,3,3,2,2,2,1,1,1,1];let n=1;for(const r of t){const t=new S(r);t.id=`ship-${n}`,Math.random()<.5&&t.rotate();let o=!1;for(;!o;){const n=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());o=e.gameboard.placeShip([n,r],t)}n++}const r=document.querySelector(`#${e.type}`);this.dom.renderShips(r,e.gameboard.ships)}drawShipsOverlay(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=document.getElementById(`ships-overlay-${e.type}`);!1===t&&(n=document.getElementById("ships-overlay-extra"),n.innerHTML=""),n.innerHTML="",e.gameboard.ships.forEach((r=>{if(!r)return;const{ship:o,row:i,col:a}=r,s=document.createElement("div"),d=10,l=i*d,h=a*d;let c,p;if("horizontal"===o.direction?(c=o.length*d,p=d):(c=d,p=o.length*d),s.style.top=`${l}%`,s.style.left=`${h}%`,s.style.width=`${c}%`,s.style.height=`${p}%`,s.classList.add("ship-overlay"),"human"===e.type&&!0===t&&s.classList.add("ship-overlay-blue"),!1===t){if("horizontal"===o.direction){if(h>60&&4===o.length)return;if(h>70&&3===o.length)return;if(h>80&&2===o.length)return;if(h>90&&1===o.length)return}else{if(l>60&&4===o.length)return;if(l>70&&3===o.length)return;if(l>80&&2===o.length)return;if(l>90&&1===o.length)return}s.classList.add("ship-overlay-green")}o.sunk&&s.classList.add("ship-overlay-red"),n.appendChild(s)}))}handleShot(e,t,n){if(n.receiveAttack(e,t))return this.updateBoards(),"computer"===this.currentPlayer.type&&this.handleComputerTurn(),this.updateBoards(),n.isAllShipsSunk()?this.handleWin():void 0;this.updateBoards(),this.switchPlayer()}switchPlayer(){this.currentPlayer=this.currentPlayer===this.player1?this.player2:this.player1,this.currentPlayer===this.player2&&this.handleComputerTurn()}handleComputerTurn(){document.getElementById("board-overlay-human").classList.add("selected-board"),setTimeout((()=>{const{row:e,col:t}=this.getRandomCoordinates();this.handleShot(e,t,this.player1.gameboard)}),1200)}getRandomCoordinates(){let e=Math.floor(10*Math.random()),t=Math.floor(10*Math.random());for(;this.player1.gameboard.missedAttacks.has(`${e},${t}`);)e=Math.floor(10*Math.random()),t=Math.floor(10*Math.random());return this.player1.gameboard.missedAttacks.add(`${e},${t}`),{row:e,col:t}}handleWin(){document.querySelector("body").appendChild(this.dom.renderNotification());const e=document.querySelector(".notification"),t=document.querySelector(".button-rematch"),n=document.querySelector(".message");"computer"===this.currentPlayer.type?(e.classList.add("notification-lose"),n.innerHTML="Game over. You lose."):(e.classList.add("notification-win"),n.innerHTML="Game over. You win."),t.addEventListener("click",(()=>{for(const e of this.players)e.gameboard.clearBoard();location.reload()}))}addListenersPreGameButtons(e){const t=document.querySelector("main"),n=document.querySelector(`#${e.type}`),r=document.getElementById("button-randomize"),o=document.getElementById("button-drag-and-drop"),i=document.getElementById("button-start-game");r.onclick=()=>{e.gameboard.clearBoard(),t.querySelector(".section-ships")&&t.querySelector(".section-ships").remove(),this.placeShipsRandomly(e),this.dom.renderBoard(n),this.dom.renderShipsDivs(e),e.gameboard.ships.forEach((t=>{const n=document.getElementById(`${t.ship.id}`),r=n.getAttribute("data-direction");e.gameboard.placeShip([t.row,t.col],t.ship),t.ship.edges=e.gameboard.getShipEdges(t.row,t.col,t.ship),e.gameboard.markShipEdges(t.ship.edges),n.onclick=()=>{this.handleShipRotation(e,n,t,r)}})),this.handleDragAndDrop(e),this.checkAllShipsPlaced(e),i.disabled=!1},o.onclick=()=>{t.innerHTML="",this.players=[this.player1],e.gameboard.clearBoard(),this.preGameSetup(e),i.disabled=!0},i.onclick=t=>{if("manual"===t.target.getAttribute("data-ship-placement")){const t=e.gameboard.ships;e.gameboard.clearBoard(),e.gameboard.ships=t;for(const n of t)e.gameboard.placeShip([n.row,n.col],n.ship);return this.player2.gameboard.clearBoard(),this.players.push(this.player2),void this.startGame()}this.player2.gameboard.clearBoard(),this.players.push(this.player2),this.startGame()}}handleDragAndDrop(e){const t=document.querySelector("body"),n=document.querySelectorAll("button[data-col][data-row]"),r=document.querySelectorAll(".ship-draggable"),o=new y("human",new v);let i,a,s,d,l;for(const t of r){const n=t.childNodes;for(const e of n)e.onmousedown=()=>{i=e.getAttribute("data-offset")};t.addEventListener("dragstart",(()=>{t.classList.remove("ship-overlay-blue"),l=t})),t.addEventListener("drag",(()=>{const n=e.gameboard.getPreviousShipData(t);if(n){let r=e.gameboard.getShipById(t.id);e.gameboard.removePreviousShip(r.ship,n[0],n[1]),e.gameboard.clearShipEdges(n[3]);for(const n of e.gameboard.ships)n.ship.id!==t.id&&e.gameboard.markShipEdges(n.ship.edges)}d=t.id,a=Number(t.getAttribute("data-length")),s=t.getAttribute("data-direction"),t.classList.add("hidden")})),t.addEventListener("dragend",(()=>{const n=document.querySelectorAll(".ship-overlay-green"),r=document.querySelector(".section-player").querySelectorAll(".ship-draggable");for(const e of r)e.classList.add("ship-overlay-blue");if(0===n.length)return t.classList.remove("hidden");for(const e of n)e.classList.remove("ship-overlay-green");const i=o.gameboard.ships[0];this.handleShipPlacement(e,i),this.shipDivPlacement(t,i),this.checkAllShipsPlaced(e),t.classList.add("ship-overlay-blue"),t.onclick=()=>{this.handleShipRotation(e,t,i,s)}}))}for(const t of n)t.addEventListener("dragover",(t=>{if(t.preventDefault(),t.target.classList.contains("ship-cell")||t.target.classList.contains("ship-draggable"))return;const n=Number(t.target.getAttribute("data-row")),r=Number(t.target.getAttribute("data-col"));o.gameboard.ships=[];const l=[],h="horizontal"===s?r-i:r,c="horizontal"===s?n:n-i;h<10&&h>=0&&n>=0&&l.push([c,h]);const p=l[0];if(void 0===p)return;let u=new S(a);return u.direction=s,u.id=d,o.gameboard.ships.push({ship:u,row:p[0],col:p[1]}),e.gameboard.isDropPossible(u,p[0],p[1])?(this.drawShipsOverlay(o,!1),o):void 0}));t.addEventListener("dragenter",(()=>{const e=document.querySelectorAll(".ship-overlay-green");for(const t of e)t.classList.remove("ship-overlay-green")}))}handleShipPlacement(e,t){if(e.gameboard.isShipExist(t.ship)){const n=e.gameboard.getPreviousShipData(t.ship);e.gameboard.removePreviousShip(t.ship,n[0],n[1]),e.gameboard.clearShipEdges(n[3]),e.gameboard.removeShipFromArray(t.ship),t.ship.edges=e.gameboard.getShipEdges(t.row,t.col,t.ship),e.gameboard.updateShipData(t.ship,t.row,t.col,t.ship.edges),e.gameboard.placeShip([t.row,t.col],t.ship),e.gameboard.markShipEdges(t.ship.edges)}else e.gameboard.placeShip([t.row,t.col],t.ship),t.ship.edges=e.gameboard.getShipEdges(t.row,t.col,t.ship),e.gameboard.markShipEdges(t.ship.edges);for(const t of e.gameboard.ships)e.gameboard.markShipEdges(t.ship.edges)}handleShipRotation(e,t,n,r){r="horizontal"===(r=t.getAttribute("data-direction"))?"vertical":"horizontal";const o=e.gameboard.getPreviousShipData(n.ship);if(!e.gameboard.isRotationPossible(n.ship,r,o[0],o[1]))return t.classList.add("ship-rotation-error"),void setTimeout((()=>{t.classList.remove("ship-rotation-error")}),400);t.setAttribute("data-direction",r),e.gameboard.removePreviousShip(n.ship,o[0],o[1]),e.gameboard.clearShipEdges(o[3]),e.gameboard.removeShipFromArray(n.ship),n.ship.direction=r,n.ship.edges=e.gameboard.getShipEdges(n.row,n.col,n.ship),e.gameboard.updateShipData(n.ship,n.row,n.col,n.ship.edges,n.ship.direction),e.gameboard.placeShip([n.row,n.col],n.ship),e.gameboard.markShipEdges(n.ship.edges);for(const t of e.gameboard.ships)e.gameboard.markShipEdges(t.ship.edges)}shipDivPlacement(e,t){document.querySelector(`[data-row="${t.row}"][data-col="${t.col}"]`).appendChild(e),e.classList.remove("hidden")}checkAllShipsPlaced(e){if(10===e.gameboard.ships.length){const e=document.getElementById("button-start-game");e.setAttribute("data-ship-placement","manual"),e.disabled=!1}}}window.addEventListener("DOMContentLoaded",(()=>new x))})();